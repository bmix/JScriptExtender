(function(){"use strict";Array.FromCollection=Array.FromCollection||function(a){for(var b=[],c=new Enumerator(a);!c.atEnd();c.moveNext())b.push(c.item());return b},Array.prototype.filter=Array.prototype.filter||function(a){if(null==this)throw new TypeError("Array.prototype.filter: this is null or not defined.");var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError("Array.prototype.filter: callback is not a function.");for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d},Array.prototype.forEach=Array.prototype.forEach||function(a,b){var c,d;if(null==this)throw new TypeError("Array.prototype.forEach: this is null or not defined");var e=Object(this),f=e.length>>>0;if("[object Function]"!={}.toString.call(a))throw new TypeError("Array.prototype.forEach: "+a+" is not a function");for(b&&(c=b),d=0;f>d;){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}},Array.prototype.map=Array.prototype.map||function(a,b){var c,d,e;if(null==this)throw new TypeError("Array.prototype.map: this is null or not defined");var f=Object(this),g=f.length>>>0;if("[object Function]"!={}.toString.call(a))throw new TypeError("Array.prototype.map: "+a+" is not a function");for(b&&(c=b),d=new Array(g),e=0;g>e;){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d},Array.prototype.reduce=Array.prototype.reduce||function(a){if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce: Object is null or undefined");var b,c=0,d=this.length>>0;if("function"!=typeof a)throw new TypeError("Array.prototype.reduce: First argument is not callable");if(arguments.length<2){if(0===d)throw new TypeError("Array.prototype.reduce: Array length is 0 and no second argument");b=this[0],c=1}else b=arguments[1];for(;d>c;)c in this&&(b=a.call(void 0,b,this[c],c,this)),++c;return b},Date.prototype.getYMDhms=Date.prototype.getYMDhms||function(){function a(a){return a>9?a:"0"+a}return"[Y]/[M]/[D] [h]:[m]:[s]".replace("[Y]",this.getFullYear()).replace("[M]",a(this.getMonth()+1)).replace("[D]",a(this.getDate())).replace("[h]",a(this.getHours())).replace("[m]",a(this.getMinutes())).replace("[s]",a(this.getSeconds()))},String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},this.Class=function(){},this.Class.extend=function(a){var b,c,d,e,f,g=function(a){var b,c,d,e=Array.prototype.slice.call(arguments,1);for(c=0;c<e.length;c++){d=e[c]||{};for(b in d)d.hasOwnProperty(b)&&(a[b]=d[b])}return a};b=function(){this.initialize&&this.initialize.apply(this,arguments)},c=function(){},c.prototype=this.prototype,d=new c,d.constructor=b,b.prototype=d;for(e in this)this.hasOwnProperty(e)&&"prototype"!==e&&(b[e]=this[e]);return a.statics&&(g(b,a.statics),delete a.statics),g(d,a),f=this,b.__super__=f.prototype,b},this.StreamReader=this.StreamReader||Class.extend({initialize:function(a){if(!a)throw new Error("StreamReader: filename is not defined.");var b=WScript.CreateObject("Scripting.FileSystemObject");try{this.sr=b.OpenTextFile(a,1,!1)}catch(c){throw new Error("StreamReader: failed to open file.")}},Close:function(){this.sr.Close()},ReadLine:function(){return this.sr.AtEndOfStream?null:this.sr.ReadLine()},ReadAll:function(){return this.sr.AtEndOfStream?"":this.sr.ReadAll()}}),this.StreamWriter=this.StreamWriter||Class.extend({initialize:function(a){if(!a)throw new Error("StreamWriter: filename is not defined.");var b=WScript.CreateObject("Scripting.FileSystemObject");try{this.sw=b.CreateTextFile(a,!0)}catch(c){throw new Error("StreamWriter: failed to open/create file.")}},Close:function(){this.sw.Close()},WriteLine:function(a){this.sw.WriteLine(a)},Write:function(a){this.sw.Write(a)}}),this.StreamUOpts=this.StreamUOpts||{adTypeBinary:1,adTypeText:2,adReadAll:-1,adReadLine:-2,adWriteChar:0,adWriteLine:1,adSaveCreateNotExist:1,adSaveCreateOverWrite:2,adCR:13,adCRLF:-1,adLF:10},this.StreamReaderU=this.StreamReaderU||Class.extend({initialize:function(a,b){if(!a)throw new Error("StreamReaderU: filename is not defined.");this.sr=new ActiveXObject("ADODB.Stream"),this.sr.Type=StreamUOpts.adTypeText,this.sr.charset="utf-8",this.sr.LineSeparator=b||StreamUOpts.adCRLF;try{this.sr.Open(),this.sr.LoadFromFile(a)}catch(c){throw new Error("StreamReaderU: failed to open file.")}},Close:function(){this.sr.Close()},ReadLine:function(){return this.sr.EOS?null:this.sr.ReadText(StreamUOpts.adReadLine)},ReadAll:function(){return this.sr.EOS?null:this.sr.ReadText(StreamUOpts.adReadAll)}}),this.StreamWriterU=this.StreamWriterU||Class.extend({initialize:function(a,b){if(!a)throw new Error("StreamWriterU: filename is not defined.");this.sw=new ActiveXObject("ADODB.Stream"),this.sw.Type=StreamUOpts.adTypeText,this.sw.charset="utf-8",this.sw.LineSeparator=b||StreamUOpts.adCRLF,this.filename=a;try{this.sw.Open(),this.Save()}catch(c){throw new Error("StreamWriterU: failed to open/create file.")}},Close:function(){this.sw.Position=0,this.sw.Type=StreamUOpts.adTypeBinary,this.sw.Position=3;var a=this.sw.Read();this.sw.Close(),this.sw.Open(),this.sw.Write(a),this.Save(),this.sw.Close()},WriteLine:function(a){this.sw.WriteText(a,StreamUOpts.adWriteLine)},Write:function(a){this.sw.WriteText(a,StreamUOpts.adWriteChar)},Save:function(){this.sw.SaveToFile(this.filename,StreamUOpts.adSaveCreateOverWrite)}}),this.Ini=this.Ini||Class.extend({initialize:function(a){this.sr=new StreamReader(a)},Load:function(){for(var a,b,c,d,e=[];null!==(a=this.sr.ReadLine());)0!==a.length&&"//"!==a.substr(0,2)&&"'"!==a.charAt(0)&&(b=a.indexOf("="),-1!==b&&(c=a.substr(0,b).trim(),d=a.substr(b+1).trim(),d.match(/^(\-){0,1}\d+(\.\d+){0,1}$/g)&&(d=+d),e[c]=d));return this.sr.Close(),e}})}).call(this);